# CSS 2D 动画

## 1.辅助

* 过渡：只能看到 **一次** 变化过程 如 **宽度  1000px  变化到  100px** `transition:all 0.3s`
* 动画：多次变化，甚至无数次；

## 2.代码

1. 定义动画的CSS
2. 给需要动画的样式内调用定义的动画

```css
/* 1 声明动画函数 */
@keyframes move {
    /* 开始状态:*/
    0% {
        transform: translateX(0px);
        background-color: red;
    }
    /* 结束状态 */
    100% {
        transform: translateX(1000px);
        background-color: #222;
    }
}

div {
    width: 200px;
    height: 200px;

    /* 2. 调用动画 */
    /* 动画名称 */
    animation-name: move;
    /* 持续时间 */
    animation-duration: 2s;
}
```

动画的全部属性：

```css
div {
    width: 100px;
    height: 100px;
    background-color: pink;
    /* 动画名称 */
    animation-name: move;

    /* 动画持续时间 */
    animation-duration: 2s; 

    /* 运动曲线 */
    /* animation-timing-function: ease; */

    /* 何时开始 */
    /*animation-delay: 1s;*/
    
    /* 重复次数  iteration 重复的 conut 次数  infinite  无限 */
    /* animation-iteration-count: infinite; */

    /* 是否反方向播放 默认的是 normal  如果想要反方向 就写 alternate */
    /* animation-direction: alternate; */

    /* 动画结束后的状态 默认的是 backwards  回到起始状态 
    我们可以让他停留在结束状态 forwards */
    /* animation-fill-mode: forwards; */

    /* animation: name duration timing-function delay iteration-count direction fill-mode; */
    /* animation: move 2s linear 0s 1 alternate forwards; */

    /* 前面2个属性 name  duration 一定要写 */
    /* animation: move 2s linear  alternate forwards; */
}

div:hover {
    /* 鼠标经过div 让这个div 停止动画，鼠标离开就继续动画 */
    animation-play-state: paused;
}
```

animation-timing-function：动画的速度曲线
```css
div{
    /* 匀速  */
    animation-timing-function: linear;

    /* 慢-快-慢  默认值  */
    animation-timing-function: ease;

    /* 慢-快  */
    animation-timing-function: ease-in;

    /* 快-慢  */
    animation-timing-function: ease-out;

    /* 慢-快-慢  */
    animation-timing-function: ease-in-out;
}
```

steps(50)：另外一种动画速度：分布跳跃式执行，就像老式的动画，分帧一帧一帧的切换；
```css
@keyframes w {
    0% {
        width: 0;
    }
    100% {
        width: 200px;
    }
}

div{
    /* 
    steps 就是分几步来完成我们的动画 
    有了steps 就不要在写 ease 或者linear 了
    效果表现为 动画在4s内，分50步跳跃式完成；
      */
    animation: w 4s steps(50) forwards;
}
```

animation-iteration-count：循坏次数
```
div{
    /* 指定次数设置  */
    animation-iteration-count: 2;

    /* 无限次数设置  */
    animation-iteration-count: infinite;
}
```

animation-direction：循环方向：若0% 红色; 100% 黑色
```css
div{
    /*1 默认值0-100 红 -> 黑 */
    animation-direction: normal;
    
    /*2 100-0 黑 -> 红 */
    animation-direction: reverse;
    
    /*3 0-100-0    红 -> 黑 -> 红 */
    animation-direction: alternate;

    /*4 100-0-100 黑 -> 红 -> 黑 */
    animation-direction: alternate-reverse;
}
```
注意：3 4 情况，需要设置多次或者无限循环。

animation-fill-mode：动画等待或者结束的状态
```css
div{
    /*1 动画结束后，元素样式停留在 100% 的样式 */
    animation-fill-mode: forwards;
    
    /*2 在延迟等待的时间内，元素样式停留在 0% 的样式 
    动画结束的时候，回到div本身的样式（回到起始状态）
    */
    animation-fill-mode: backwards;
    
    /*3 同时设置了 forwards和backwards两个属性值
    在动画等待时间，样式为元素样式停留在 0% 的样式，
    动画结束时，元素样式停留在 100% 的样式
     */
    animation-fill-mode: both;
}
```

animation-play-state：暂停和播放
```css
div{
    /*1 播放 */
    animation-play-state: running;
    
    /*2 暂停*/
    animation-play-state: paused;
}
```

animation：复合写法的顺序
```css
div{
    /*1 动画名称 持续时间 速度曲线 等待时间 执行次数 执行的方向 动画等待或结束的状态 */
    animation: name duration timing-function delay iteration-count direction fill-mode;
}
```

animationend：动画结束事件
```js
    var div = document.querySelector("div");
    div.addEventListener("animationend", function () {
      console.log("div的动画结束之后，触发");
    });
```

注意：

1. 设置动画，必须有要开始定义动画，调用动画和设置动画时间；
2. 动画的0-100%这种节点，是动画的时间节点，默认动画运行完成，回到初始化状态，这里的初始化不是指0%的状态，是标签本身的没有动画之前的状态；
3. 一般动画的执行方向需要设置执行的次数。
4. 等待或结束的状态一般不需要设置动画执行为无限次数；

------------------------

【demo1】大数据热点 第一种写法

```html
<div class="city">
    <div class="p"></div>
    <div class="pulse1"></div>
    <div class="pulse2"></div>
    <div class="pulse3"></div>
</div>
```

```css
body {
    background-color: #333;
}

/* 初始定义动画*/
@keyframes pulse {
    0% {}
    70% {
        /* 使用比例的时候，一定要确认基准点没有动*/
        transform: scale(5);
        opacity: 1;
    }
    100% {
        /**/
        transform: scale(6);
        opacity: 0;
    }
}


.city {
    position: absolute;
    top: 100px;
    right: 200px;
    color: #fff;
}

.tb {
    top: 500px;
    right: 80px;
}

/* 屏幕上了可以看到的那个点*/
.p {
    width: 8px;
    height: 8px;
    background-color: #09f;
    border-radius: 50%;
}

/* 点下面的三个往外扩散的圈圈 动画的统一设置*/
.city div[class^="pulse"] {
    position: absolute;
    top: 0;
    left: 0;
    width: 8px;
    height: 8px;
    box-shadow: 0 0 12px #009dfd;
    border-radius: 50%;
    animation: pulse 1.2s linear infinite;
}

/* 设置第二个圈的延迟执行*/
.city div.pulse2 {
    animation-delay: 0.4s;
}

/* 设置第3个圈的延迟执行*/
.city div.pulse3 {
    animation-delay: 0.8s;
}
```
该写法设置的变化设置了transform: scale(5)的比例变化，看到的效果是长宽在等比变化，box-shadow也在变化；这就说明了scale会把目标本身设置的宽、高、box-shadow会变化，注意基准点在哪里position: absolute；

【demo1】大数据热点 第2种写法
```css
body {
    background-color: #333;
}

/* 初始定义动画*/
@keyframes pulse {
    0% {}
    70% {
        /* 急转点位置发生改变，就不能使用scale，只能改宽高，性能不好*/
        width: 40px;
        height: 40px;
        opacity: 1;
    }
    100% {
        width: 70px;
        height: 70px;
        opacity: 0;
    }
}


.city {
    position: absolute;
    top: 100px;
    right: 200px;
    color: #fff;
}

/* 屏幕上了可以看到的那个点*/
.p {
    width: 8px;
    height: 8px;
    background-color: #09f;
    border-radius: 50%;
}

/* 保证我们小波纹在父盒子里面水平垂直居中 放大之后就会中心向四周发散*/
.city div[class^="pulse"] {
    /* 文档流的位置发生改变*/
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 8px;
    height: 8px;
    box-shadow: 0 0 12px #009dfd;
    border-radius: 50%;
    animation: pulse 1.2s linear infinite;
}

/* 设置第二个圈的延迟执行*/
.city div.pulse2 {
    animation-delay: 0.4s;
}

/* 设置第3个圈的延迟执行*/
.city div.pulse3 {
    animation-delay: 0.8s;
}
```
注意：

1. 首先在定位扩散圈的时候使用的定位进行居中，保证在盒子在中间；
2. 那么接下来动画的放大只能使用设置新的宽高，不能设置比例放大。使用的话会表现为扩散的圈圈在移动，尽管你是上下左右居中。原因就是真实的文档流的位置已经发生变化；

【demo2】奔跑的熊

1. 遇到这样的业务，首先你要看你拿到的熊的图示静态的分帧图，还是动态图。
2. 本案拿到的就是个分帧图；分析场景：分帧图我们就想用什么实现，先让熊的动画动起来；（step）
3. 熊是可以自己写动起来，那如何让他向前走，那就需要写另外一个动画，让他往前移动；

```css
/* 1.设置熊的底图。先让熊出现*/
div {
    position: absolute;
    width: 200px;
    height: 100px;
    background: url(media/bear.png) no-repeat;
}

/* 2.设计分帧图的动画，先让熊自己在原地跑起来。*/
@keyframes bear {
    0% {
        background-position: 0 0;
    }
    100% {
        /* 1600px 是因为给我们的图就是这个宽度。*/
        background-position: -1600px 0;
    }
}

div {
    position: absolute;
    width: 200px;
    height: 100px;
    background: url(media/bear.png) no-repeat;
    /* 设置熊自己跑起来的动画，这里为什么是8步完成，因为熊的底图有8个分帧动画，所以要8步完成看起来更连续 */
    animation: bear .4s steps(8) infinite;
}


/* 2.设计让熊向前跑起来的动画。*/
@keyframes move {
    0% {
        left: 0;
    }
    100% {
        left: 50%;
        /* margin-left: -100px; */
        transform: translateX(-50%);
    }
}

div {
    position: absolute;
    width: 200px;
    height: 100px;
    background: url(media/bear.png) no-repeat;
    /* 我们元素可以添加多个动画， 用逗号分隔 */
    animation: bear .4s steps(8) infinite, 
    move 3s forwards;
}
```

总结：这个案例我们首先不要着急代码怎么写，先要看到自己拿到的是什么，就是你的业务和素材都是什么；其次就是分析怎么去实现，用哪些样式；

----

CSS3的兼容：css3涉及到较多的新属性，某些低版本（如ie8以及以下）的浏览器对css3的支持程度不够，因此需要做以下处理。添加对应的浏览器的前缀 常见前缀如下

- 谷歌 -webkit
- 火狐 -moz
- IE -ms

```css
div{
    -webkit-border-radius: 30px 10px;
    -moz-border-radius: 30px 10px;
    -ms-border-radius: 30px 10px;
    /* border-radius 一定要放在最后 */
    border-radius: 30px 10px;
}
```







